<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level Up: Firsts in Life | B2 Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 50%, #fff7ed 100%);
            min-height: 100vh;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #e2e8f0;
            border-radius: 10px;
        }

        .tab-active-vocab { background-color: #f97316; color: white; border-color: #fb923c; }
        .tab-active-grammar { background-color: #4f46e5; color: white; border-color: #818cf8; }
        .tab-active-quiz { background-color: #ec4899; color: white; border-color: #f472b6; }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Header -->
    <header class="max-w-6xl mx-auto mb-8 flex flex-col md:flex-row md:items-center justify-between gap-6">
        <div class="fade-in">
            <div class="flex items-center gap-3 mb-2">
                <div class="bg-orange-500 p-2 rounded-xl shadow-lg rotate-3 text-white">
                    <i class="fas fa-book-open fa-2x"></i>
                </div>
                <h1 class="text-3xl md:text-4xl font-black bg-gradient-to-r from-indigo-600 via-purple-600 to-orange-500 bg-clip-text text-transparent">
                    Level Up: Firsts in Life
                </h1>
            </div>
            <p class="text-slate-500 font-medium flex items-center gap-2">
                <i class="fas fa-bullseye text-orange-400"></i> B2 Academic Mastery Dashboard
            </p>
        </div>
        
        <div class="flex items-center gap-4 bg-white p-4 rounded-[2rem] shadow-xl border-2 border-orange-100">
            <div class="relative">
                <div class="w-14 h-14 bg-gradient-to-tr from-orange-400 to-pink-500 rounded-full flex items-center justify-center text-white shadow-lg border-2 border-white">
                    <i class="fas fa-user-tie fa-2xl"></i>
                </div>
                <div class="absolute -bottom-1 -right-1 bg-green-400 w-4 h-4 rounded-full border-2 border-white"></div>
            </div>
            <div>
                <p class="text-[10px] text-slate-400 uppercase font-black tracking-widest leading-none mb-1">Coach Janelle</p>
                <p class="font-black text-indigo-900 text-lg">Online Now âœ¨</p>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="max-w-6xl mx-auto mb-10 flex flex-wrap justify-center gap-4">
        <button onclick="switchTab('vocab')" id="btn-vocab" class="tab-btn flex items-center gap-3 py-4 px-8 rounded-full border-2 font-black transition-all duration-300 shadow-sm bg-white text-slate-500 border-slate-100 tab-active-vocab">
            <i class="fas fa-brain"></i> B2 Lexicon
        </button>
        <button onclick="switchTab('grammar')" id="btn-grammar" class="tab-btn flex items-center gap-3 py-4 px-8 rounded-full border-2 font-black transition-all duration-300 shadow-sm bg-white text-slate-500 border-slate-100">
            <i class="fas fa-pen-nib"></i> Master Patterns
        </button>
        <button onclick="switchTab('quiz')" id="btn-quiz" class="tab-btn flex items-center gap-3 py-4 px-8 rounded-full border-2 font-black transition-all duration-300 shadow-sm bg-white text-slate-500 border-slate-100">
            <i class="fas fa-trophy"></i> Ultimate Challenge
        </button>
    </nav>

    <!-- Content Sections -->
    <main class="max-w-6xl mx-auto">
        
        <!-- VOCABULARY SECTION -->
        <section id="section-vocab" class="content-section">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
                <div class="lg:col-span-8 flex flex-col items-center">
                    <div id="vocab-card" class="w-full bg-white rounded-[3rem] shadow-2xl border-b-[12px] border-orange-400 p-10 md:p-16 text-center relative overflow-hidden transition-all duration-500">
                        <div id="vocab-number" class="absolute top-8 right-12 text-orange-100 font-black text-9xl select-none opacity-40">1</div>
                        <div class="relative z-10">
                            <div id="vocab-pos" class="inline-block px-4 py-1 rounded-full bg-orange-100 text-orange-600 font-black text-xs uppercase tracking-widest mb-6">adj.</div>
                            <h2 id="vocab-word" class="text-5xl md:text-7xl font-black text-slate-800 tracking-tighter mb-4">memorable</h2>
                            <h3 id="vocab-def" class="text-2xl font-bold text-slate-500 mb-10">é›£å¿˜çš„</h3>
                            
                            <div id="vocab-example-container" class="hidden animate-in fade-in duration-500 max-w-2xl mx-auto text-left">
                                <div class="p-6 bg-white rounded-3xl border-2 border-orange-200 shadow-inner">
                                    <p id="vocab-example" class="text-lg text-slate-700 font-medium mb-4 italic"></p>
                                    <p id="vocab-ch" class="text-slate-400 font-medium"></p>
                                </div>
                            </div>
                            <button id="btn-reveal" onclick="revealExample()" class="mt-4 bg-orange-500 text-white px-8 py-4 rounded-2xl font-black hover:bg-orange-600 transition-all shadow-lg">REVEAL CONTEXT</button>
                        </div>
                    </div>
                    <div class="flex items-center gap-6 mt-10">
                        <button onclick="prevVocab()" class="w-16 h-16 rounded-3xl bg-white shadow-xl flex items-center justify-center text-slate-400 hover:text-orange-500 transition-all border border-slate-50"><i class="fas fa-chevron-left fa-2x"></i></button>
                        <div id="vocab-counter" class="bg-white px-8 py-4 rounded-3xl font-black text-2xl text-slate-700 shadow-lg">1 / 16</div>
                        <button onclick="nextVocab()" class="w-16 h-16 rounded-3xl bg-orange-500 shadow-xl flex items-center justify-center text-white hover:bg-orange-600 transition-all"><i class="fas fa-chevron-right fa-2x"></i></button>
                    </div>
                </div>
                <div class="lg:col-span-4 bg-white p-6 rounded-[2.5rem] shadow-xl border border-slate-100">
                    <h3 class="text-2xl font-black text-slate-800 mb-6 flex items-center gap-2"><i class="fas fa-heart text-pink-500"></i> Phrases</h3>
                    <div id="idioms-list" class="space-y-3 max-h-[500px] overflow-y-auto pr-2 custom-scrollbar">
                        <!-- Idioms injected here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- GRAMMAR SECTION -->
        <section id="section-grammar" class="content-section hidden">
            <div class="space-y-10 fade-in">
                <div class="bg-gradient-to-br from-indigo-900 to-purple-900 rounded-[4rem] p-10 md:p-16 text-white shadow-2xl">
                    <h2 class="text-4xl md:text-5xl font-black mb-8">Reporting with <span class="text-orange-400">that</span></h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                        <div class="bg-white/10 p-8 rounded-[2rem] border border-white/20">
                            <h4 class="font-black text-orange-400 flex items-center gap-2 mb-4"><i class="fas fa-exclamation-triangle"></i> Common Pitfalls</h4>
                            <ul class="space-y-4 text-sm">
                                <li><span class="text-red-400 font-black">âœ—</span> "He reminded that he was late."</li>
                                <li><span class="text-green-400 font-black">âœ“</span> "He reminded <span class="underline">us</span> that he was late." (Object needed!)</li>
                                <li><span class="text-red-400 font-black">âœ—</span> "I realized that I am wrong."</li>
                                <li><span class="text-green-400 font-black">âœ“</span> "I realized that I <span class="underline">was</span> wrong." (Past tense backshifting)</li>
                            </ul>
                        </div>
                        <div class="space-y-4">
                            <h4 class="font-black text-2xl">B2 Usage Cases</h4>
                            <div class="p-5 bg-indigo-700/50 rounded-2xl border border-indigo-500/30 text-sm italic">"The data <strong>indicated that</strong> our primary strategy was failing."</div>
                            <div class="p-5 bg-indigo-700/50 rounded-2xl border border-indigo-500/30 text-sm italic">"I <strong>suggest that</strong> everyone dress up for the presentation."</div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-[4rem] p-10 md:p-16 shadow-2xl border-2 border-indigo-50">
                    <h3 class="text-3xl font-black text-slate-800 mb-8 flex items-center gap-4 text-orange-500"><i class="fas fa-bolt"></i> Gerund Essentials</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-orange-50 p-8 rounded-3xl border-2 border-orange-100">
                            <h5 class="font-black text-orange-600 mb-4 text-xl underline">Verb + V-ing Only</h5>
                            <div class="grid grid-cols-2 gap-2 text-slate-700 font-bold">
                                <div>â€¢ Enjoy</div><div>â€¢ Avoid</div><div>â€¢ Consider</div><div>â€¢ Practice</div><div>â€¢ Quit</div><div>â€¢ Mind</div>
                            </div>
                        </div>
                        <div class="p-8 bg-indigo-50 rounded-3xl border-2 border-indigo-100">
                            <p class="font-black text-indigo-900 mb-2 italic">Teacher Janelle's Tip:</p>
                            <p class="text-indigo-800 text-sm leading-relaxed">Never say "suggest to go." In academic writing, we use <strong>suggest going</strong> or <strong>suggest that we go</strong>.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- QUIZ SECTION -->
        <section id="section-quiz" class="content-section hidden">
            <div id="quiz-container" class="max-w-4xl mx-auto py-10">
                <!-- Quiz dynamically injected here -->
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="max-w-6xl mx-auto mt-20 p-10 bg-white rounded-[4rem] shadow-xl flex flex-col md:flex-row gap-8 items-center border border-slate-50">
        <div class="w-24 h-24 bg-gradient-to-tr from-pink-500 to-orange-400 rounded-full flex-shrink-0 flex items-center justify-center text-white text-4xl shadow-xl">
            <i class="fas fa-user-graduate"></i>
        </div>
        <div>
            <h4 class="text-2xl font-black text-indigo-900 mb-2">Coach Janelle's Tip</h4>
            <p id="footer-tip" class="text-indigo-800 italic">"Remember, a B2 student doesn't just know the word; they know the word's 'grammar friends'."</p>
        </div>
    </footer>

    <script>
        // --- DATA ---
        const vocabulary = [
            { word: "memorable", pos: "adj.", def: "é›£å¿˜çš„", example: "The amazing white sand beaches, friendly people, and delicious food made our trip truly memorable.", ch: "ä»¤äººé©šå˜†çš„ç™½è‰²æ²™ç˜ã€å‹å–„çš„äººå€‘ï¼Œä»¥åŠç¾Žå‘³çš„é£Ÿç‰©è®“æˆ‘å€‘çš„æ³°åœ‹ä¹‹æ—…å¯¦åœ¨é›£å¿˜ã€‚" },
            { word: "reply", pos: "n./v.", def: "å›žç­”ï¼›å›žè¦†", example: "In reply to your question about my health, I am feeling much better now.", ch: "å›žè¦†ä½ é—œæ–¼æˆ‘å¥åº·çš„å•é¡Œï¼Œæˆ‘ç¾åœ¨è¦ºå¾—å¥½å¤šäº†ã€‚" },
            { word: "yell", pos: "vi.", def: "å¤§å–Šï¼›å¤§å¼", example: "George was yelling at his family in the middle of the night.", ch: "Georgeåœ¨åŠå¤œå°ä»–çš„å®¶äººå¤§å«ã€‚" },
            { word: "perfect", pos: "adj.", def: "å®Œç¾Žçš„", example: "John was very careful with his car, so it was still in perfect condition.", ch: "Johnå°æ–¼ä»–çš„è»Šå­ååˆ†å°å¿ƒï¼Œæ‰€ä»¥ä½¿ç”¨äº”å¹´ä¹‹å¾Œè»Šå­ä¾ç„¶ä¿æŒå®Œç¾Žç‹€æ…‹ã€‚" },
            { word: "accidentally", pos: "adv.", def: "æ„å¤–åœ°ï¼›ä¸å°å¿ƒåœ°", example: "Sheila accidentally spilled coffee on her new dress.", ch: "Sheilaä¸å°å¿ƒæŠŠå’–å•¡æ½‘åœ¨å¥¹çš„æ–°æ´‹è£ä¸Šã€‚" },
            { word: "failure", pos: "n.", def: "å¤±æ•—", example: "The teamâ€™s plan to have a picnic ended in failure.", ch: "å› ç‚ºé‚£ç³Ÿç³•çš„å¤©æ°£ï¼Œå°çµ„æƒ³è¦é‡Žé¤çš„è¨ˆç•«ä»¥å¤±æ•—å‘Šçµ‚ã€‚" },
            { word: "recall", pos: "vt.", def: "è¨˜èµ·ï¼›å›žæƒ³èµ·", example: "Yvonneâ€™s grandmother recalled that she married the most handsome man in town at twenty.", ch: "Yvonneçš„ç¥–æ¯å›žæƒ³èµ·å¥¹äºŒåæ­²æ™‚å«çµ¦äº†éŽ®ä¸Šæœ€å¸¥çš„ç”·äººã€‚" },
            { word: "presentation", pos: "n.", def: "å ±å‘Šï¼›ä»‹ç´¹", example: "Each student must give a presentation on one movie.", ch: "æ¯ä½å­¸ç”Ÿå¿…é ˆåœ¨å­¸æœŸæœ«å°±ä¸€éƒ¨é›»å½±ä½œå ±å‘Šã€‚" },
            { word: "skip", pos: "vt.", def: "æ•…æ„ä¸åƒåŠ ï¼›ç•¥éŽ", example: "I donâ€™t usually skip class because I donâ€™t like to fall behind.", ch: "æˆ‘é€šå¸¸ä¸ç¼ºèª²ï¼Œå› ç‚ºæˆ‘ä¸å–œæ­¡è½å¾Œæˆ‘çš„åŒå­¸ã€‚" },
            { word: "ruin", pos: "vt.", def: "ç ´å£žï¼›æ¯€å£ž", example: "Mandyâ€™s sandcastle was suddenly ruined when a big wave splashed onto it.", ch: "Mandyçš„æ²™å ¡çªç„¶è¢«ä¸€å€‹å¤§æµªæ‹æ‰“åˆ°è€Œæ¯€å£žã€‚" },
            { word: "embarrassed", pos: "adj.", def: "å°·å°¬çš„ï¼›é›£å ªçš„", example: "Amy was really embarrassed about her mistake during the dance class.", ch: "Amyå°æ–¼å¥¹åœ¨èˆžè¹ˆèª²æ™‚æ‰€çŠ¯çš„éŒ¯èª¤ï¼Œæ„Ÿåˆ°éžå¸¸å°·å°¬ã€‚" },
            { word: "depressed", pos: "adj.", def: "æ²®å–ªçš„", example: "Emilia felt deeply depressed after her smartphone was stolen.", ch: "Emiliaåœ¨å¥¹çš„æ™ºæ…§åž‹æ‰‹æ©Ÿè¢«å·å¾Œï¼Œæ„Ÿåˆ°éžå¸¸æ²®å–ªã€‚" },
            { word: "upset", pos: "vt./adj.", def: "ä½¿é›£éŽï¼›é›£éŽçš„", example: "You shouldnâ€™t speak to your parents in an impolite way since you could upset them.", ch: "ä½ ä¸æ‡‰è©²ç”¨ä¸ç¦®è²Œçš„æ–¹å¼è·Ÿä½ çš„çˆ¶æ¯è¦ªèªªè©±ï¼Œå› ç‚ºä½ å¯èƒ½æœƒä½¿é›£éŽã€‚" },
            { word: "reflect", pos: "vi./vt.", def: "æ€è€ƒï¼›æ˜ å‡º", example: "Barbara spent a whole week reflecting on her college choice.", ch: "BarbaraèŠ±äº†ä¸€æ•´å€‹æ˜ŸæœŸèªçœŸæ€è€ƒè¦ä¸Šå“ªä¸€é–“å¤§å­¸ã€‚" },
            { word: "remind", pos: "vt.", def: "æé†’ï¼›ä½¿æƒ³èµ·", example: "Ms. Chen reminded her students of the importance of checking homework.", ch: "é™³è€å¸«æé†’å¥¹çš„å­¸ç”Ÿå€‘æª¢æŸ¥ä»–å€‘ä½œæ¥­çš„é‡è¦æ€§ã€‚" },
            { word: "realize", pos: "vt.", def: "äº†è§£ï¼›é ˜æ‚Ÿ", example: "Matt suddenly realized that the time on his watch was wrong.", ch: "Mattçªç„¶äº†è§£åˆ°ï¼Œä»–æ‰‹éŒ¶ä¸Šçš„æ™‚é–“æ˜¯éŒ¯çš„ã€‚" }
        ];

        const idioms = [
            { phrase: "the rest (of)", def: "å…¶é¤˜ï¼ˆçš„...ï¼‰", example: "Daryl took a few bites and gave the rest of it to his sister." },
            { phrase: "in person", def: "è¦ªè‡ª", example: "Deborah decided to visit the museum in person to see the paintings." },
            { phrase: "take...seriously", def: "èªçœŸçœ‹å¾…", example: "Archie loves making fun of people, so donâ€™t take his words seriously." },
            { phrase: "let...down", def: "è®“...å¤±æœ›", example: "Roy promised he would attend, and he didnâ€™t let her down." },
            { phrase: "make sure", def: "ç¢ºä¿ï¼›ç¢ºå®š", example: "Please make sure that you donâ€™t go over the speed limit." },
            { phrase: "put...first", def: "èªç‚º...æœ€é‡è¦", example: "Most parents put their childrenâ€™s needs first." },
            { phrase: "dress up", def: "è£æ‰®", example: "Every Halloween, the cousins dress up as cartoon characters." }
        ];

        const quizQuestions = [
            { type: "mc", q: "Which verb correctly completes this academic sentence: 'Market analysts have ______ that consumer behavior is shifting toward sustainable products.'", options: ["recalled", "realized", "indicated", "ruined"], correct: 2 },
            { type: "error", q: "Find the error: 'The teacher reminded that all students should submit their projects by Friday to avoid failure.'", options: ["reminded that", "should submit", "by Friday", "avoid failure"], correct: 0, fix: "reminded us that (remind requires an object!)" },
            { type: "type", q: "Vocabulary: Use the adjective form. 'He felt deeply __________ after his proposal was rejected for the third time.'", answer: "depressed", hint: "d _ _ _ _ _ _ _ d" },
            { type: "mc", q: "Idiom Challenge: 'High-performing teams usually ______ the collective goal ______ rather than individual success.'", options: ["take...personally", "put...first", "make...sure", "let...down"], correct: 1 },
            { type: "type", q: "Grammar: 'He avoids to skip class.' (Identify and fix the verb form).", answer: "skipping", hint: "s _ _ _ _ _ _ g" },
            { type: "error", q: "Spot the mistake: 'The manager suggested that he avoids making the same presentation again.'", options: ["suggested that", "avoids", "making", "same presentation"], correct: 1, fix: "avoid (Subjunctive: suggest that S + base verb)" },
            { type: "mc", q: "Contextual Choice: 'If you want people to respect you, you must learn to ______ on your mistakes and take them ______.'", options: ["recall; personally", "reflect; seriously", "yell; accidentally", "reply; perfectly"], correct: 1 },
            { type: "type", q: "Word Family: 'The vacation was so fun; it was a truly __________ experience.'", answer: "memorable", hint: "m _ _ _ _ _ _ _ e" },
            { type: "mc", q: "Which idiom fits? 'I don't want to ______ my parents ______ by failing this important exam.'", options: ["take...seriously", "let...down", "dress...up", "make...sure"], correct: 1 },
            { type: "error", q: "Error Check: 'By the time I arrived, I realized that I accidentally have left my wallet at home.'", options: ["arrived", "realized that", "accidentally", "have left"], correct: 3, fix: "had left (Past Perfect needed)" }
        ];

        // --- STATE ---
        let currentVocabIdx = 0;
        let currentQuizIdx = 0;
        let score = 0;
        let isQuizFinished = false;

        // --- VOCABULARY LOGIC ---
        function updateVocabUI() {
            const item = vocabulary[currentVocabIdx];
            document.getElementById('vocab-number').innerText = currentVocabIdx + 1;
            document.getElementById('vocab-pos').innerText = item.pos;
            document.getElementById('vocab-word').innerText = item.word;
            document.getElementById('vocab-def').innerText = item.def;
            document.getElementById('vocab-example').innerText = `"${item.example}"`;
            document.getElementById('vocab-ch').innerText = item.ch;
            document.getElementById('vocab-counter').innerText = `${currentVocabIdx + 1} / ${vocabulary.length}`;
            
            document.getElementById('vocab-example-container').classList.add('hidden');
            document.getElementById('btn-reveal').classList.remove('hidden');
            document.getElementById('vocab-card').classList.remove('bg-orange-50');
        }

        function nextVocab() {
            currentVocabIdx = (currentVocabIdx + 1) % vocabulary.length;
            updateVocabUI();
        }

        function prevVocab() {
            currentVocabIdx = (currentVocabIdx - 1 + vocabulary.length) % vocabulary.length;
            updateVocabUI();
        }

        function revealExample() {
            document.getElementById('vocab-example-container').classList.remove('hidden');
            document.getElementById('btn-reveal').classList.add('hidden');
            document.getElementById('vocab-card').classList.add('bg-orange-50');
        }

        function loadIdioms() {
            const list = document.getElementById('idioms-list');
            list.innerHTML = idioms.map(item => `
                <div class="p-4 bg-slate-50 rounded-2xl hover:bg-indigo-50 transition-all">
                    <p class="font-black text-indigo-600">${item.phrase}</p>
                    <p class="text-xs text-slate-400 mb-1">${item.def}</p>
                    <p class="text-xs text-slate-500 italic">"${item.example}"</p>
                </div>
            `).join('');
        }

        // --- TAB LOGIC ---
        function switchTab(tab) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.className = "tab-btn flex items-center gap-3 py-4 px-8 rounded-full border-2 font-black transition-all duration-300 shadow-sm bg-white text-slate-500 border-slate-100";
            });

            document.getElementById(`section-${tab}`).classList.remove('hidden');
            document.getElementById(`btn-${tab}`).classList.add(`tab-active-${tab}`);

            if (tab === 'quiz') startQuiz();
        }

        // --- QUIZ LOGIC ---
        function startQuiz() {
            currentQuizIdx = 0;
            score = 0;
            isQuizFinished = false;
            renderQuestion();
        }

        function renderQuestion() {
            const container = document.getElementById('quiz-container');
            const q = quizQuestions[currentQuizIdx];

            let content = `
                <div class="bg-white rounded-[4rem] shadow-2xl border-2 border-pink-100 min-h-[500px] flex flex-col overflow-hidden fade-in">
                    <div class="bg-slate-50 p-6 flex justify-between border-b">
                        <div class="flex items-center gap-3">
                            <div class="bg-pink-500 text-white w-10 h-10 rounded-xl flex items-center justify-center font-black">${currentQuizIdx + 1}</div>
                            <p class="text-sm font-bold text-slate-700">Question ${currentQuizIdx + 1} of 10</p>
                        </div>
                        <p class="text-lg font-black text-pink-600">Score: ${score}</p>
                    </div>
                    <div class="p-10 md:p-16 flex-grow flex flex-col justify-center">
                        <h2 class="text-2xl md:text-3xl font-black text-slate-800 text-center mb-12">${q.q}</h2>
            `;

            if (q.type === 'mc' || q.type === 'error') {
                content += `<div class="grid grid-cols-1 md:grid-cols-2 gap-4">`;
                q.options.forEach((opt, idx) => {
                    content += `<button onclick="handleAnswer(${idx})" class="quiz-opt p-6 rounded-3xl font-black text-left border-2 bg-white border-slate-100 text-slate-600 hover:border-pink-300 transition-all">${opt}</button>`;
                });
                content += `</div>`;
            } else {
                content += `
                    <div class="space-y-6 max-w-xl mx-auto w-full">
                        <div class="text-center text-pink-300 font-black tracking-widest text-2xl uppercase mb-2">${q.hint}</div>
                        <input type="text" id="type-input" class="w-full text-center text-3xl font-black p-6 bg-slate-50 rounded-3xl border-4 border-dashed border-pink-100 focus:outline-none focus:border-pink-500" placeholder="...">
                        <button onclick="handleTypeAnswer()" class="w-full bg-indigo-900 text-white py-6 rounded-3xl font-black text-xl hover:bg-indigo-800 transition-all">SUBMIT</button>
                    </div>
                `;
            }

            content += `
                    <div id="feedback" class="mt-8 text-center text-2xl font-black hidden"></div>
                </div></div>
            `;
            container.innerHTML = content;
        }

        function handleAnswer(idx) {
            const q = quizQuestions[currentQuizIdx];
            const isCorrect = idx === q.correct;
            showFeedback(isCorrect, q.fix);
        }

        function handleTypeAnswer() {
            const val = document.getElementById('type-input').value.trim().toLowerCase();
            const q = quizQuestions[currentQuizIdx];
            const isCorrect = val === q.answer.toLowerCase();
            showFeedback(isCorrect);
        }

        function showFeedback(isCorrect, fix = null) {
            if (isCorrect) score++;
            
            const fb = document.getElementById('feedback');
            fb.classList.remove('hidden');
            fb.className = `mt-8 text-center text-2xl font-black ${isCorrect ? 'text-green-500' : 'text-red-500'} animate-bounce`;
            fb.innerHTML = isCorrect ? "ðŸŽ¯ CORRECT!" : "ðŸ’¡ WRONG!";
            if (!isCorrect && fix) fb.innerHTML += `<p class="text-sm block mt-2 text-slate-400">Context: ${fix}</p>`;

            setTimeout(() => {
                currentQuizIdx++;
                if (currentQuizIdx < quizQuestions.length) renderQuestion();
                else renderResults();
            }, 1500);
        }

        function getEncouragement(s) {
            if (s === 10) return { title: "Absolute Master! ðŸ†", msg: "Stellar performance! You've completely mastered the B2 structure of this unit.", color: "text-yellow-600", icon: "rocket" };
            if (s >= 7) return { title: "Fantastic Job! âœ¨", msg: "You're nearly there! Re-check the 'Master Patterns' to polish those last few points.", color: "text-green-600", icon: "sparkles" };
            if (s >= 4) return { title: "Great Progress! ðŸ’ª", msg: "You have a solid foundation. Revisit the Gerund rules and backshifting tenses.", color: "text-orange-600", icon: "smile" };
            return { title: "Keep Going! ðŸŒ±", msg: "Every expert started as a beginner. Spend time with the Lexicon and try again!", color: "text-blue-600", icon: "heart" };
        }

        function renderResults() {
            const enc = getEncouragement(score);
            const container = document.getElementById('quiz-container');
            container.innerHTML = `
                <div class="bg-white rounded-[4rem] p-10 md:p-16 text-center shadow-2xl border-4 border-indigo-50 fade-in">
                    <div class="flex justify-center mb-6">
                        <i class="fas fa-${enc.icon} fa-5x text-yellow-500 drop-shadow-lg"></i>
                    </div>
                    <h2 class="text-5xl font-black mb-4 ${enc.color}">${enc.title}</h2>
                    <p class="text-2xl font-bold text-slate-700 mb-6">You scored <span class="text-indigo-600">${score}</span> / 10</p>
                    <div class="bg-slate-50 p-8 rounded-3xl border-2 border-slate-100 mb-10 max-w-2xl mx-auto italic text-slate-600 text-lg">
                        "${enc.msg}"
                    </div>
                    <button onclick="startQuiz()" class="bg-slate-900 text-white px-12 py-6 rounded-3xl font-black hover:scale-105 transition-all shadow-xl flex items-center gap-3 mx-auto">
                        <i class="fas fa-redo"></i> RETRY CHALLENGE
                    </button>
                </div>
            `;
        }

        // --- INIT ---
        window.onload = () => {
            updateVocabUI();
            loadIdioms();
        };
    </script>
</body>
</html>